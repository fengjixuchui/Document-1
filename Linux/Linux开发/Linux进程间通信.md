# Linux进程间通信（IPC）

IPC：InterProcess Communication



## Linux下的文件类型

- \- 文件
- d 目录
- l 符号链接
- s 套接字
- b 块设备
- c 字符设备
- p 管道



文件、目录、符号链接是占用磁盘存储的。其它的不占用，其它的统一称为`伪文件`



## 管道

```c
       #include <unistd.h>

       int pipe(int fildes[2]);
```

返回两个文件描述符：fd[0]为读而打开，fd[1]为写而打开



1. 其本质是一个伪文件（实为内核缓冲区）
2. 由两个文件描述符引用，一个表示读端，一个表示写端
3. 规定数据从管道的写端流入管道，从读端流出

管道的原理：管道实为内核使用环形队列机制，借助内核缓冲区(4K)实现



### 管道的局限性

1. 双向半双工，因此，数据只能在一个方向上流动
2. 只能在有公共祖先的进程间使用管道
3. 数据自己读不能自己写
4. 数据一旦被读走，便不在管道中存在，不可反复读取



## FIFO(有名管道)



### 非阻塞标志(O_NONBLOCK)：

- 阻塞模式：只读open要阻塞到某个进程以只写方式打开此FIFO，只写open要阻塞到某个进程以只读方式打开此FIFO;

- 非阻塞模式：只读立即返回，如果没有进程以只读方式打开FIFO，则只写open返回-1，erron=ENXIO;



### 一端关闭

- 若读一个已经关闭写端的FIFO，则读取完数据后，会读到文件结束符，read返回0；

- 若写一个已经关闭读端的FIFO，则产生SIGPIPE;



代码详见：code/fifo

## 共享内存



